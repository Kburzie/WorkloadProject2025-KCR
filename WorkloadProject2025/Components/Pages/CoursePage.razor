@page "/CoursePage"
@using WorkloadProject2025.Data.Models
@using WorkloadProject2025.Services
@inject CourseService courseService

<h3>Course Page</h3>

<div class="row">
    <div class="col-md-6">
        <CoursesForm OnCourseSaved="LoadCourses"></CoursesForm>
    </div>
    <div class="col-md-6">
        <MudCard>
            <MudCardHeader>
                <MudText Typo="Typo.h6">Course List</MudText>
            </MudCardHeader>
            <MudCardContent>
                @if (courses == null)
                {
                    <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
                }
                else if (!courses.Any())
                {
                    <MudText>No courses available</MudText>
                }
                else
                {
                    <MudTable Items="@courses" Hover="true" Dense="true">
                        <HeaderContent>
                            <MudTh>ID</MudTh>
                            <MudTh>Course Name</MudTh>
                            <MudTh>Hours</MudTh>
                        </HeaderContent>
                        <RowTemplate>
                            <MudTd DataLabel="ID">@context.Id</MudTd>
                            <MudTd DataLabel="Course Name">@context.Name</MudTd>
                            <MudTd DataLabel="Hours">@context.Hours</MudTd>
                        </RowTemplate>
                    </MudTable>
                }
            </MudCardContent>
        </MudCard>
    </div>
</div>

@code {
    private List<Course>? courses;

    protected override async Task OnInitializedAsync()
    {
        await LoadCourses();
    }

    private async Task LoadCourses()
    {
        courses = await courseService.GetAllAsync();
        StateHasChanged();
    }
}
